DELETE T FROM (SELECT *, DupRank = ROW_NUMBER() OVER (PARTITION BY PessoaId ORDER BY (SELECT NULL)) FROM SMFCLEAN.dbo.PessoaTemp) AS T WHERE DupRank > 1 